<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juego tipo Guitar Hero</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow: hidden;
        }

        header {
            width: 100%;
            background-color: #005a9c;
            color: white;
            padding: 15px;
            text-align: center;
            font-size: 24px;
        }

        .linea {
            position: absolute;
            top: 50%;
            left: 0;
            width: 100%;
            height: 4px;
            background-color: black;
        }

        .zona-hit {
            position: absolute;
            top: 50%;
            left: 30%;
            width: 50px;
            height: 20px;
            background-color: red;
            transform: translate(-50%, -50%);
        }

        .esfera,
        .snare {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            left: 100%;
        }

        .esfera {
            width: 60px;
            height: 60px;
            background-color: black;
            border-radius: 50%;
        }

        .snare {
            width: 0;
            height: 0;
            border-left: 30px solid transparent;
            border-right: 30px solid transparent;
            border-bottom: 60px solid #DF7F33;
        }

        #score-container {
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #score {
            font-size: 20px;
            margin-bottom: 10px;
        }

        #speed-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #speed {
            margin-top: 5px;
            width: 300px;
        }

        .slider-label {
            font-size: 16px;
            color: #333;
        }
    </style>
</head>

<body>
    <header>
        <h1>Juego Tipo Guitar Hero</h1>
    </header>

    <div class="linea"></div>
    <div class="zona-hit"></div>

    <div id="score-container">
        <div id="score">Puntos: 0</div>
        <div id="speed-container">
            <label class="slider-label" for="speed">Rapido - - - Lento :</label>
            <input type="range" id="speed" min="250" max="500" value="250">
        </div>
    </div>

    <script>
        const patrones = {
            chico: ['E', 'T', 'T', 'X', 'E', 'T', 'T', 'X', 'E', 'T', 'T', 'X'],
            repique: ['E', 'X', 'T', 'E', 'X', 'E', 'T', 'E', 'X', 'X', 'E', 'T'],
            piano: ['T', 'X', 'T', 'T', 'E', 'X', 'T', 'X', 'T', 'T']
        };

        let currentPattern = 0, repetitions = 0, score = 0;
        let ritmo = 250; // Velocidad inicial

        // Obtener el slider y agregar un evento para actualizar la velocidad
        const slider = document.getElementById('speed');
        slider.addEventListener('input', (event) => {
            ritmo = event.target.value; // Actualizar la velocidad según el slider
        });

        function crearElemento(tipo) {
            const elemento = document.createElement('div');
            elemento.className = tipo === 'hit' ? 'esfera' : 'snare';
            document.body.appendChild(elemento);
            moverElemento(elemento);
        }

       

        function verificarHit() {
    const elementos = document.querySelectorAll('.esfera, .snare');
    elementos.forEach(elemento => {
        const rect = elemento.getBoundingClientRect();
        const zonaHit = document.querySelector('.zona-hit').getBoundingClientRect();

        const enZonaHit = (
            rect.right >= zonaHit.left &&
            rect.left <= zonaHit.right &&
            rect.top <= zonaHit.bottom &&
            rect.bottom >= zonaHit.top
        );

        if (enZonaHit && event.code === 'Space') {
            // Eliminar el elemento instantáneamente si se presiona la barra espaciadora
            document.body.removeChild(elemento);
            score++;
            document.getElementById('score').innerText = `Puntos: ${score}`;
        }
    });
}

function moverElemento(elemento) {
    let position = window.innerWidth;
    const animacion = setInterval(() => {
        if (position < -70) {
            clearInterval(animacion);
            document.body.removeChild(elemento); // Eliminar al llegar al borde
        } else {
            elemento.style.left = (position -= 10) + 'px';
        }
    }, 20);

    // Establecer un timeout para iniciar la animación de desvanecimiento
    const fadeOutTime = 3000; // Tiempo en milisegundos antes de desvanecer (ajusta según necesites)
   

    setTimeout(() => {
        // Aplicar desvanecimiento si no se verifica el hit
        elemento.style.transition = "opacity 0.3s ease";
        elemento.style.opacity = 0; // Comienza a desvanecerse
        setTimeout(() => {
            document.body.removeChild(elemento); // Eliminar después de desvanecer
        }, 300);
    }, fadeOutTime);
}


        function crearPatron() {
            const patron = Object.values(patrones)[currentPattern];
            let index = 0;

            function procesarNota() {
                if (index >= patron.length) {
                    repetitions++;
                    if (repetitions >= 3) {
                        repetitions = 0;
                        currentPattern = (currentPattern + 1) % Object.keys(patrones).length;
                    }
                    setTimeout(crearPatron, 500);
                    return;
                }

                const simbolo = patron[index++];
                if (simbolo === 'E') crearElemento('hit');
                if (simbolo === 'T') crearElemento('snare');
                if (simbolo === 'X') {
                    index++;
                }

                const delay = simbolo === 'X' ? 200 : ritmo;
                setTimeout(procesarNota, delay);
            }

            procesarNota();
        }

        document.addEventListener('keydown', (event) => {
            if (event.code === 'Space') {
                verificarHit();
            }
        });

        crearPatron();
    </script>
</body>

</html>
